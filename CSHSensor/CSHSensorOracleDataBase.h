

#pragma once


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


#include <occi.h>


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


class CCSHSensorOracleDataBase
{
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public: 
		CCSHSensorOracleDataBase(TCHAR *pCurrentOracleUserName, TCHAR *pCurrentOracleUserPassword, TCHAR *pCurrentOracleUserTableName, TCHAR *pCurrentOracleServiceName);


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		~CCSHSensorOracleDataBase();


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		BOOL currentOracleDataBaseConfigurationFlag;


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		oracle::occi::Environment *currentOracleEnvironment;


	public:
		oracle::occi::Connection *currentOracleConnection;


	public:
		oracle::occi::Statement *currentOracleStatement;


	public:
		oracle::occi::ResultSet *currentOracleResultSet;


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		std::string currentOracleUserName;


	public:
		std::string currentOracleUserPassword;


	public:
		std::string currentOracleTableName;


	public:
		std::string currentOracleServiceName;


	public:
		std::string currentOracleSQLTransactionStatement;


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID CleanUpOracleInstance();


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID CreateOracleInstanceEnvironment();


	public:
		VOID DeleteOracleInstanceEnvironment();


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID CreateOracleInstanceConnection();


	public:
		VOID DeleteOracleInstanceConnection();


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID CreateOracleInstanceStatement(TCHAR *pCurrentSQLTransactionStatement);


	public:
		VOID DeleteOracleInstanceStatement();


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		BOOL excuteOracleInstanceStatement(TCHAR *pCurrentActiveUserID = NULL, TCHAR *pCurrentActiveUserPassword = NULL);


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID DeleteOracleInstanceResultSet();


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID ConvertWideCharToMultyByteCharANSI(CONST TCHAR *pWideCharString, CHAR *pMultyByteCharString);


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID ConvertMultyByteCharToWideCharANSI(CONST CHAR *pMultyByteCharString, TCHAR *pWideCharString);


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID ConvertWideCharToMultyByteCharUTF8(CONST TCHAR *pWideCharString, CHAR *pMultyByteCharString);


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	public:
		VOID ConvertMultyByteCharToWideCharUTF8(CONST CHAR *pMultyByteCharString, TCHAR *pWideCharString);


	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
};
